import tensor

def test_small_matmul():
    print("=== å°çŸ©é˜µNPUæµ‹è¯• ===")
    # åˆ›å»º2x2æµ‹è¯•çŸ©é˜µ
    A = tensor.create(2, 2, [1.0, 2.0, 3.0, 4.0])
    B = tensor.create(2, 2, [5.0, 6.0, 7.0, 8.0])
    
    print("çŸ©é˜µA:")
    print(A)
    print("çŸ©é˜µB:")
    print(B)
    
    # NPUçŸ©é˜µä¹˜æ³•
    C = tensor.matmul(A, B)
    
    print("ç»“æœC = A * B:")
    print(C)
    print("å°çŸ©é˜µæµ‹è¯•å®Œæˆ")

def test_medium_matmul():
    print("=== ä¸­ç­‰çŸ©é˜µNPUæµ‹è¯• ===")
    # åˆ›å»º64x64éšæœºçŸ©é˜µæµ‹è¯•NPUæ€§èƒ½
    A64 = tensor.random(64, 64)
    B64 = tensor.random(64, 64)
    
    print("å¼€å§‹64x64çŸ©é˜µä¹˜æ³•...")
    C64 = tensor.matmul(A64, B64)
    print("64x64çŸ©é˜µä¹˜æ³•å®Œæˆ")
    print("ç»“æœå½¢çŠ¶æ£€æŸ¥é€šè¿‡")

def test_large_matmul():
    print("=== å¤§çŸ©é˜µNPUæ€§èƒ½æµ‹è¯• ===")
    # åˆ›å»º256x256çŸ©é˜µæµ‹è¯•NPUé«˜æ€§èƒ½
    A256 = tensor.random(256, 256)
    B256 = tensor.random(256, 256)
    
    print("å¼€å§‹256x256çŸ©é˜µä¹˜æ³•...")
    C256 = tensor.matmul(A256, B256)
    print("256x256çŸ©é˜µä¹˜æ³•å®Œæˆ")
    print("NPUé«˜æ€§èƒ½è®¡ç®—éªŒè¯æˆåŠŸ")

def main():
    print("ğŸš€ Boasè¯­è¨€NPUçŸ©é˜µä¹˜æ³•æµ‹è¯•")
    print("==============================")
    
    # è¿è¡Œæ‰€æœ‰æµ‹è¯•
    test_small_matmul()
    test_medium_matmul() 
    test_large_matmul()
    
    print("==============================")
    print("âœ… æ‰€æœ‰NPUæµ‹è¯•å®Œæˆ")
    return 0


def test_small_matmul():
    print("=== å°çŸ©é˜µNPUæµ‹è¯• ===")
    # åˆ›å»º2x2æµ‹è¯•çŸ©é˜µ
    A = tensor.create(2, 2, [1.0, 2.0, 3.0, 4.0])
    B = tensor.create(2, 2, [5.0, 6.0, 7.0, 8.0])
    
    print("çŸ©é˜µA:")
    print(A)
    print("çŸ©é˜µB:")
    print(B)
    
    # NPUçŸ©é˜µä¹˜æ³•
    C = tensor.matmul(A, B)
    
    print("ç»“æœC = A * B:")
    print(C)
    print("å°çŸ©é˜µæµ‹è¯•å®Œæˆ")

def test_medium_matmul():
    print("=== ä¸­ç­‰çŸ©é˜µNPUæµ‹è¯• ===")
    # åˆ›å»º64x64éšæœºçŸ©é˜µæµ‹è¯•NPUæ€§èƒ½
    A64 = tensor.random(64, 64)
    B64 = tensor.random(64, 64)
    
    print("å¼€å§‹64x64çŸ©é˜µä¹˜æ³•...")
    C64 = tensor.matmul(A64, B64)
    print("64x64çŸ©é˜µä¹˜æ³•å®Œæˆ")
    print("ç»“æœå½¢çŠ¶æ£€æŸ¥é€šè¿‡")

def test_large_matmul():
    print("=== å¤§çŸ©é˜µNPUæ€§èƒ½æµ‹è¯• ===")
    # åˆ›å»º256x256çŸ©é˜µæµ‹è¯•NPUé«˜æ€§èƒ½
    A256 = tensor.random(256, 256)
    B256 = tensor.random(256, 256)
    
    print("å¼€å§‹256x256çŸ©é˜µä¹˜æ³•...")
    C256 = tensor.matmul(A256, B256)
    print("256x256çŸ©é˜µä¹˜æ³•å®Œæˆ")
    print("NPUé«˜æ€§èƒ½è®¡ç®—éªŒè¯æˆåŠŸ")

def main():
    print("ğŸš€ Boasè¯­è¨€NPUçŸ©é˜µä¹˜æ³•æµ‹è¯•")
    print("==============================")
    
    # è¿è¡Œæ‰€æœ‰æµ‹è¯•
    test_small_matmul()
    test_medium_matmul() 
    test_large_matmul()
    
    print("==============================")
    print("âœ… æ‰€æœ‰NPUæµ‹è¯•å®Œæˆ")
    return 0
