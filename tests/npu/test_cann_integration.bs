import tensor

def test_cann_matmul():
    # 测试真正的CANN集成
    var A = tensor.create(8, 8, [
        1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
        2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 1.0,
        3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 1.0, 2.0,
        4.0, 5.0, 6.0, 7.0, 8.0, 1.0, 2.0, 3.0,
        5.0, 6.0, 7.0, 8.0, 1.0, 2.0, 3.0, 4.0,
        6.0, 7.0, 8.0, 1.0, 2.0, 3.0, 4.0, 5.0,
        7.0, 8.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0,
        8.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0
    ])
    
    var B = tensor.create(8, 8, [
        8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0,
        7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 8.0,
        6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 8.0, 7.0,
        5.0, 4.0, 3.0, 2.0, 1.0, 8.0, 7.0, 6.0,
        4.0, 3.0, 2.0, 1.0, 8.0, 7.0, 6.0, 5.0,
        3.0, 2.0, 1.0, 8.0, 7.0, 6.0, 5.0, 4.0,
        2.0, 1.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0,
        1.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0
    ])
    
    var C = tensor.matmul(A, B)
    return C

def main():
    var result = test_cann_matmul()
    return result

def test_cann_matmul():
    # 测试真正的CANN集成
    var A = tensor.create(8, 8, [
        1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0,
        2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 1.0,
        3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 1.0, 2.0,
        4.0, 5.0, 6.0, 7.0, 8.0, 1.0, 2.0, 3.0,
        5.0, 6.0, 7.0, 8.0, 1.0, 2.0, 3.0, 4.0,
        6.0, 7.0, 8.0, 1.0, 2.0, 3.0, 4.0, 5.0,
        7.0, 8.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0,
        8.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0
    ])
    
    var B = tensor.create(8, 8, [
        8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0,
        7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 8.0,
        6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 8.0, 7.0,
        5.0, 4.0, 3.0, 2.0, 1.0, 8.0, 7.0, 6.0,
        4.0, 3.0, 2.0, 1.0, 8.0, 7.0, 6.0, 5.0,
        3.0, 2.0, 1.0, 8.0, 7.0, 6.0, 5.0, 4.0,
        2.0, 1.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0,
        1.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0
    ])
    
    var C = tensor.matmul(A, B)
    return C

def main():
    var result = test_cann_matmul()
    return result
